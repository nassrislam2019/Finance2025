<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÖÿ≠ŸÅÿ∏ÿ™Ÿä ÿßŸÑÿ∞ŸÉŸäÿ© - Smart Wallet</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: '#050505',
                        cardDark: '#1C1C1E',
                    }
                }
            }
        }
    </script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100 dark:bg-[#050505] transition-colors duration-300">
    
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ŸÇÿßŸÖŸàÿ≥ ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© ---
        const DICTIONARY = {
            en: {
                totalBalance: "Total Balance", wallets: "Wallets", addWallet: "Add Wallet", editWallet: "Edit Wallet",
                walletName: "Wallet Name", initialBalance: "Current Balance", available: "Available", income: "Income",
                spent: "Spent", recentActivity: "Recent Activity", seeAll: "See All", spendingTrend: "Weekly Flow",
                categoryBreakdown: "Category Breakdown", aiDetected: "AI Detected", confirmSave: "Confirm & Save",
                sayPlaceholder: "Say 'Spent 200 on lunch'...", amount: "Amount", category: "Category", note: "Note",
                home: "Wallet", insights: "Insights", planning: "Planning", settings: "Settings", theme: "Appearance",
                language: "Language", noTx: "No transactions yet.", monthlyCap: "Monthly Capacity", healthScore: "Financial Health",
                critical: "Critical", good: "Healthy", spendingWarning: "High Spending Alert", safeSpending: "Safe Zone",
                edit: "Edit", delete: "Delete", save: "Save", cancel: "Cancel", obligations: "Obligations", collections: "Collections",
                dueDate: "Due Day", markPaid: "Mark as Paid", addToTitle: "Add Item", type: "Type"
            },
            ar: {
                totalBalance: "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ±ÿµŸäÿØ", wallets: "ÿßŸÑŸÖÿ≠ÿßŸÅÿ∏ ŸàÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™", addWallet: "ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≠ŸÅÿ∏ÿ©", editWallet: "ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©",
                walletName: "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©", initialBalance: "ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑÿ≠ÿßŸÑŸä", available: "ÿßŸÑŸÖÿ™ÿßÿ≠", income: "ÿßŸÑÿØÿÆŸÑ",
                spent: "ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™", recentActivity: "ÿ¢ÿÆÿ± ÿßŸÑŸÖÿπÿßŸÖŸÑÿßÿ™", seeAll: "ÿßŸÑŸÉŸÑ", spendingTrend: "ÿßŸÑÿ™ÿØŸÅŸÇ ÿßŸÑÿ£ÿ≥ÿ®ŸàÿπŸä",
                categoryBreakdown: "ÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™", aiDetected: "ÿßŸÑŸÖÿπÿßŸÖŸÑÿ© ÿßŸÑŸÖŸÉÿ™ÿ¥ŸÅÿ©", confirmSave: "ÿ™ÿ£ŸÉŸäÿØ Ÿàÿ≠ŸÅÿ∏",
                sayPlaceholder: "ŸÇŸÑ 'ÿµÿ±ŸÅÿ™ Ÿ•Ÿ†Ÿ† ŸÅŸä ŸÉÿßÿ±ŸÅŸàÿ±'...", amount: "ÿßŸÑŸÖÿ®ŸÑÿ∫", category: "ÿßŸÑÿ™ÿµŸÜŸäŸÅ", note: "ŸÖŸÑÿßÿ≠ÿ∏ÿ©",
                home: "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©", insights: "ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±", planning: "ÿ™ÿÆÿ∑Ÿäÿ∑", settings: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™", theme: "ÿßŸÑŸÖÿ∏Ÿáÿ±",
                language: "ÿßŸÑŸÑÿ∫ÿ©", noTx: "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿπÿßŸÖŸÑÿßÿ™.", monthlyCap: "ÿßŸÑŸÇÿØÿ±ÿ© ÿßŸÑÿ¥Ÿáÿ±Ÿäÿ©", healthScore: "ÿßŸÑÿµÿ≠ÿ© ÿßŸÑŸÖÿßŸÑŸäÿ©",
                critical: "ÿ≠ÿ±ÿ¨", good: "ÿ¨ŸäÿØ", spendingWarning: "ÿ™ŸÜÿ®ŸäŸá ÿ•ŸÜŸÅÿßŸÇ ÿπÿßŸÑŸä", safeSpending: "ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ£ŸÖÿßŸÜ",
                edit: "ÿ™ÿπÿØŸäŸÑ", delete: "ÿ≠ÿ∞ŸÅ", save: "ÿ≠ŸÅÿ∏", cancel: "ÿ•ŸÑÿ∫ÿßÿ°", obligations: "ÿßŸÑÿ™ÿ≤ÿßŸÖÿßÿ™ ÿ¥Ÿáÿ±Ÿäÿ©", collections: "ÿ™ÿ≠ÿµŸäŸÑÿßÿ™ ÿ¥Ÿáÿ±Ÿäÿ©",
                dueDate: "ŸäŸàŸÖ ÿßŸÑÿßÿ≥ÿ™ÿ≠ŸÇÿßŸÇ", markPaid: "ÿ™ŸÖ ÿßŸÑÿØŸÅÿπ", addToTitle: "ÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÜÿØ", type: "ÿßŸÑŸÜŸàÿπ"
            }
        };

        // --- ÿ£ŸäŸÇŸàŸÜÿßÿ™ SVG ---
        const Icons = {
            Wallet: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><path d="M20 7h-3a2 2 0 0 1-2-2V3"/><path d="M9 18a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/><path d="M3 14v1a2 2 0 0 0 2 2h3"/><rect x="3" y="10" width="18" height="11" rx="2"/></svg>,
            BarChart3: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>,
            Calendar: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
            Settings: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            Mic: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>,
            Plus: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
            ArrowUpRight: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><line x1="7" y1="17" x2="17" y2="7"/><polyline points="7 7 17 7 17 17"/></svg>,
            ArrowDownLeft: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><line x1="17" y1="7" x2="7" y2="17"/><polyline points="17 17 7 17 7 7"/></svg>,
            Trash2: () => <svg width="16" height="16" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>,
            Edit2: () => <svg width="16" height="16" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>,
            X: () => <svg width="20" height="20" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            Zap: () => <svg width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            CreditCard: () => <svg width="20" height="20" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>,
            CheckSquare: () => <svg width="18" height="18" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>,
            Square: () => <svg width="18" height="18" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/></svg>
        };

        const parseVoiceCommand = (text, lang) => {
            if (!text || !text.trim()) return { amount: 0, type: 'expense', category: lang === 'ar' ? 'ÿπÿßŸÖ' : 'General', description: '' };
            const lower = text.toLowerCase();
            let amount = 0;
            let type = 'expense';
            let category = lang === 'ar' ? 'ÿπÿßŸÖ' : 'General';
            
            const enNum = text.match(/\d+(\.\d+)?/);
            const arNumMatch = text.match(/[\u0660-\u0669]+/);
            
            if (enNum) amount = parseFloat(enNum[0]);
            if (!enNum && arNumMatch) {
                const arDigits = arNumMatch[0].replace(/[Ÿ†-Ÿ©]/g, d => '0123456789'['Ÿ†Ÿ°Ÿ¢Ÿ£Ÿ§Ÿ•Ÿ¶ŸßŸ®Ÿ©'.indexOf(d)]);
                amount = parseFloat(arDigits);
            }

            const keywords = {
                income: ['income', 'salary', 'deposit', 'ÿØÿÆŸÑ', 'ÿ±ÿßÿ™ÿ®', 'ŸÖÿ±ÿ™ÿ®', 'ŸÇÿ®ÿ∂', 'ÿ™ÿ≠ŸàŸäŸÑ'],
                food: ['food', 'lunch', 'dinner', 'coffee', 'burger', 'ÿ£ŸÉŸÑ', 'ÿ∫ÿØÿßÿ°', 'ÿπÿ¥ÿßÿ°', 'ŸÇŸáŸàÿ©', 'ŸÖÿ∑ÿπŸÖ', 'ÿ≥Ÿàÿ®ÿ± ŸÖÿßÿ±ŸÉÿ™', 'ÿ®ŸÇÿßŸÑ', 'ŸÉÿßÿ±ŸÅŸàÿ±'],
                transport: ['uber', 'car', 'fuel', 'bus', 'transport', 'ÿ®ŸÜÿ≤ŸäŸÜ', 'ŸÖŸàÿßÿµŸÑÿßÿ™', 'ÿßŸàÿ®ÿ±', 'ÿ™ÿßŸÉÿ≥Ÿä', 'ÿπÿ±ÿ®Ÿäÿ©', 'ÿ≥Ÿäÿßÿ±ÿ©'],
                bills: ['rent', 'bill', 'wifi', 'electricity', 'fatora', 'ÿßŸäÿ¨ÿßÿ±', 'ŸÉŸáÿ±ÿ®ÿßÿ°', 'ŸÅÿßÿ™Ÿàÿ±ÿ©', 'ŸÜÿ™', 'ŸÖŸäÿßŸá', 'ÿ∫ÿßÿ≤', 'subscription', 'netflix', 'spotify', 'ÿßÿ¥ÿ™ÿ±ÿßŸÉ'],
                shopping: ['shop', 'clothes', 'amazon', 'shoes', 'zara', 'ŸÖŸÑÿßÿ®ÿ≥', 'ÿ¥ÿ±ÿßÿ°', 'ŸÖŸàŸÑ', 'ÿ¨ÿ≤ŸÖÿ©', 'ŸÜŸàŸÜ', 'ÿßŸÖÿßÿ≤ŸàŸÜ'],
                health: ['gym', 'doctor', 'pharmacy', 'medicine', 'ÿØŸÉÿ™Ÿàÿ±', 'ÿµŸäÿØŸÑŸäÿ©', 'ÿπŸÑÿßÿ¨', 'ÿØŸàÿßÿ°', 'ÿ¨ŸäŸÖ'],
                entertainment: ['movie', 'game', 'party', 'ÿ≥ŸäŸÜŸÖÿß', 'ŸÅŸäŸÑŸÖ', 'ŸÑÿπÿ®ÿ©', 'ÿ®ŸÑÿßŸäÿ≥ÿ™Ÿäÿ¥ŸÜ']
            };

            if (keywords.income.some(k => lower.includes(k))) type = 'income';

            if (keywords.food.some(k => lower.includes(k))) category = lang === 'ar' ? 'ÿ∑ÿπÿßŸÖ Ÿàÿ¥ÿ±ÿ®' : 'Food & Dining';
            else if (keywords.transport.some(k => lower.includes(k))) category = lang === 'ar' ? 'ŸÖŸàÿßÿµŸÑÿßÿ™' : 'Transport';
            else if (keywords.bills.some(k => lower.includes(k))) category = lang === 'ar' ? 'ŸÅŸàÿßÿ™Ÿäÿ±' : 'Bills';
            else if (keywords.shopping.some(k => lower.includes(k))) category = lang === 'ar' ? 'ÿ™ÿ≥ŸàŸÇ' : 'Shopping';
            else if (keywords.health.some(k => lower.includes(k))) category = lang === 'ar' ? 'ÿµÿ≠ÿ©' : 'Health';
            else if (keywords.entertainment.some(k => lower.includes(k))) category = lang === 'ar' ? 'ÿ™ÿ±ŸÅŸäŸá' : 'Entertainment';

            let description = text.replace(/[0-9Ÿ†-Ÿ©]/g, '')
                .replace(/(egp|le|pounds|spent|on|in|paid|received|via|by|ÿ¨ŸÜŸäÿ©|ÿ¨ŸÜŸäŸá|ÿµÿ±ŸÅÿ™|ÿØŸÅÿπÿ™|ŸÅŸä|ÿπŸÑŸâ)/gi, '')
                .trim();
            if (!description) description = category;
            return { amount: isNaN(amount) ? 0 : amount, type, category, description };
        };

        const ProgressBar = ({ value = 0, max = 1, color = 'bg-blue-500' }) => {
            const width = Math.min(100, Math.max(0, (value / (max || 1)) * 100));
            return (
                <div className="h-2 w-full bg-gray-200 dark:bg-white/10 rounded-full overflow-hidden">
                    <div className={`h-full rounded-full transition-all duration-1000 ease-out ${color}`} style={{ width: `${width}%` }} />
                </div>
            );
        };

        const SimpleBarChart = ({ data, theme }) => {
            if(!data || data.length === 0) return null;
            const maxVal = Math.max(...data.map(d => d.amount)) || 1;
            return (
                <div className="flex items-end justify-between h-48 w-full gap-2 pt-4">
                    {data.map((d, i) => (
                        <div key={i} className="flex flex-col items-center gap-1 flex-1 group">
                            <div className="relative w-full flex justify-center items-end h-full">
                                <div 
                                    className={`w-full max-w-[20px] rounded-t-md transition-all duration-500 ${d.amount > 2000 ? 'bg-red-500' : 'bg-blue-500'} opacity-80 group-hover:opacity-100`}
                                    style={{ height: `${(d.amount / maxVal) * 100}%` }}
                                ></div>
                                <div className="absolute -top-8 bg-black text-white text-[10px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10">
                                    {d.amount}
                                </div>
                            </div>
                            <span className="text-[10px] text-gray-400">{d.name}</span>
                        </div>
                    ))}
                </div>
            )
        };

        const Modal = ({ isOpen, onClose, title, children, theme }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in">
                    <div className={`w-full max-w-md rounded-3xl p-6 shadow-2xl transform transition-all ${theme === 'dark' ? 'bg-[#1C1C1E] text-white border border-white/10' : 'bg-white text-black'}`}>
                        <div className="flex justify-between items-center mb-4">
                            <h3 className="text-xl font-bold">{title}</h3>
                            <button onClick={onClose}><Icons.X /></button>
                        </div>
                        {children}
                    </div>
                </div>
            );
        };

        const SmartWallet = () => {
            // --- ÿ≠ŸÖÿßŸäÿ© ÿßŸÑÿ∞ÿßŸÉÿ±ÿ© (Storage Safe Guard) ---
            const loadData = (key, def) => {
                try {
                    const saved = localStorage.getItem(key);
                    if (saved) return JSON.parse(saved);
                } catch (e) {
                    console.warn("Storage access blocked:", e);
                }
                return def;
            };

            const saveDataToStorage = (key, val) => {
                try {
                    localStorage.setItem(key, JSON.stringify(val));
                } catch (e) {
                    console.warn("Storage save blocked:", e);
                }
            };

            const [view, setView] = useState('home');
            
            // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿ£ŸÖÿßŸÜ
            const [transactions, setTransactions] = useState(() => loadData('wallet_transactions', []));
            const [wallets, setWallets] = useState(() => loadData('wallet_wallets', []));
            const [recurringItems, setRecurringItems] = useState(() => loadData('wallet_recurring', []));

            const [lang, setLang] = useState('ar');
            const [theme, setTheme] = useState('dark');
            const [editingTx, setEditingTx] = useState(null);
            const [walletModalOpen, setWalletModalOpen] = useState(false);
            const [editingWallet, setEditingWallet] = useState(null);
            const [planningModalOpen, setPlanningModalOpen] = useState(false);
            const [editingPlanItem, setEditingPlanItem] = useState(null);
            const [command, setCommand] = useState('');
            const [aiResult, setAiResult] = useState(null);
            const [isProcessing, setIsProcessing] = useState(false);

            // ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿ£ŸÖÿßŸÜ ÿπŸÜÿØ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±
            useEffect(() => { saveDataToStorage('wallet_transactions', transactions); }, [transactions]);
            useEffect(() => { saveDataToStorage('wallet_wallets', wallets); }, [wallets]);
            useEffect(() => { saveDataToStorage('wallet_recurring', recurringItems); }, [recurringItems]);

            useEffect(() => {
                if (theme === 'dark') document.documentElement.classList.add('dark');
                else document.documentElement.classList.remove('dark');
            }, [theme]);

            const colors = {
                bg: theme === 'dark' ? 'bg-[#050505]' : 'bg-[#F2F2F7]',
                card: theme === 'dark' ? 'bg-[#1C1C1E] border-white/10' : 'bg-white border-gray-200 shadow-sm',
                text: theme === 'dark' ? 'text-white' : 'text-black',
                textMuted: theme === 'dark' ? 'text-gray-500' : 'text-gray-500',
                nav: theme === 'dark' ? 'bg-[#050505]/90 border-white/10' : 'bg-white/90 border-gray-200',
                input: theme === 'dark' ? 'bg-[#1C1C1E] border-white/10 text-white' : 'bg-white border-gray-300 text-black'
            };

            const t = (key) => (DICTIONARY[lang] && DICTIONARY[lang][key]) || key;
            const formatMoney = (n) => new Intl.NumberFormat(lang === 'en' ? 'en-EG' : 'ar-EG', { style: 'currency', currency: 'EGP', maximumFractionDigits: 0 }).format(n);

            const saveTransaction = (data) => {
                if (data.id) {
                    setTransactions(transactions.map(t => t.id === data.id ? data : t));
                } else {
                    const newTx = { ...data, id: Date.now().toString(), date: new Date().toISOString() };
                    setTransactions([newTx, ...transactions]);
                }
                setAiResult(null); setCommand(''); setEditingTx(null);
            };

            const deleteTransaction = (id) => {
                if (!confirm(t('delete') + '?')) return;
                setTransactions(transactions.filter(t => t.id !== id));
                setEditingTx(null);
            };

            const saveWallet = (e) => {
                e.preventDefault();
                const form = e.target;
                const data = { 
                    name: form.name.value, 
                    balance: parseFloat(form.balance.value), 
                    color: form.color.value || 'blue' 
                };
                
                if (editingWallet?.id) {
                    setWallets(wallets.map(w => w.id === editingWallet.id ? { ...w, ...data } : w));
                } else {
                    setWallets([...wallets, { ...data, id: Date.now().toString() }]);
                }
                setWalletModalOpen(false); setEditingWallet(null);
            };

            const deleteWallet = (id) => {
                if (!confirm(t('delete') + '?')) return;
                setWallets(wallets.filter(w => w.id !== id));
            };

            const savePlanningItem = (e) => {
                e.preventDefault();
                const form = e.target;
                const data = { 
                    title: form.title.value, 
                    amount: parseFloat(form.amount.value), 
                    day: parseInt(form.day.value), 
                    type: form.type.value, 
                    isPaid: false 
                };
                
                if (editingPlanItem?.id) {
                    setRecurringItems(recurringItems.map(i => i.id === editingPlanItem.id ? { ...i, ...data } : i));
                } else {
                    setRecurringItems([...recurringItems, { ...data, id: Date.now().toString() }]);
                }
                setPlanningModalOpen(false); setEditingPlanItem(null);
            };

            const deletePlanningItem = (id) => {
                setRecurringItems(recurringItems.filter(i => i.id !== id));
            };
            
            const togglePlanningStatus = (item) => {
                setRecurringItems(recurringItems.map(i => i.id === item.id ? { ...i, isPaid: !i.isPaid } : i));
            };

            const stats = useMemo(() => {
                const income = transactions.filter(tx => tx.type === 'income').reduce((a, b) => a + (b.amount || 0), 0);
                const expense = transactions.filter(tx => tx.type === 'expense').reduce((a, b) => a + (b.amount || 0), 0);
                const walletsBalance = wallets.reduce((acc, w) => acc + (w.balance || 0), 0);
                const totalBalance = wallets.length > 0 ? walletsBalance : (income - expense);
                const spendingRate = income > 0 ? (expense / income) * 100 : 0;
                
                const last7Days = Array.from({ length: 7 }, (_, i) => {
                    const d = new Date(); d.setDate(d.getDate() - i);
                    return d.toISOString().split('T')[0];
                }).reverse();

                const weeklyChart = last7Days.map(date => {
                    const dayAmt = transactions.filter(t => t.type === 'expense' && (t.date || '').startsWith(date)).reduce((a, b) => a + (b.amount || 0), 0);
                    const dayName = new Date(date).toLocaleDateString(lang === 'ar' ? 'ar-EG' : 'en-US', { weekday: 'short' });
                    return { name: dayName, amount: dayAmt };
                });

                const categories = {};
                transactions.filter(t => t.type === 'expense').forEach(t => {
                    const cat = t.category || (lang === 'ar' ? 'ÿπÿßŸÖ' : 'General');
                    categories[cat] = (categories[cat] || 0) + (t.amount || 0);
                });
                const categoryList = Object.entries(categories).map(([name, value]) => ({ name, value })).sort((a, b) => b.value - a.value);

                return { income, expense, totalBalance, spendingRate, weeklyChart, categoryList };
            }, [transactions, wallets, lang]);

            const handleCommand = (e) => {
                e.preventDefault();
                if (!command) return;
                setIsProcessing(true);
                setTimeout(() => {
                    const result = parseVoiceCommand(command, lang);
                    setAiResult(result);
                    setIsProcessing(false);
                }, 600);
            };

            return (
                <div dir={lang === 'ar' ? 'rtl' : 'ltr'} className={`min-h-screen ${colors.bg} ${colors.text} font-sans transition-colors duration-300 pb-24`}>
                    
                    <header className={`sticky top-0 z-40 px-6 pt-12 pb-4 flex justify-between items-center backdrop-blur-xl transition-all ${theme === 'dark' ? 'bg-[#050505]/80' : 'bg-[#F2F2F7]/80'}`}>
                        <div>
                            <h1 className={`text-xs font-medium ${colors.textMuted}`}>{t('totalBalance')}</h1>
                            <p className="text-2xl font-bold tracking-tight">{formatMoney(stats.totalBalance)}</p>
                        </div>
                        <button onClick={() => setView('settings')} className={`p-2 rounded-full border ${theme === 'dark' ? 'border-white/10 bg-white/5' : 'border-gray-300 bg-white'}`}>
                            <div className={colors.textMuted}><Icons.Settings /></div>
                        </button>
                    </header>

                    {view === 'home' && (
                        <div className="space-y-6 animate-in fade-in slide-in-from-bottom-4">
                            <div className="overflow-x-auto px-6 pb-4 scrollbar-hide">
                                <div className="flex gap-4 min-w-max">
                                    <button onClick={() => { setEditingWallet(null); setWalletModalOpen(true); }} className={`w-16 h-48 rounded-3xl flex flex-col items-center justify-center gap-2 border border-dashed ${theme === 'dark' ? 'border-white/20 bg-white/5' : 'border-gray-300 bg-gray-50'}`}>
                                        <div className="opacity-50"><Icons.Plus /></div>
                                        <span className="text-xs font-medium vertical-rl opacity-50" style={{writingMode: 'vertical-rl'}}>{t('addWallet')}</span>
                                    </button>
                                    {wallets.length === 0 && (
                                        <div className="w-64 h-48 rounded-3xl bg-gradient-to-br from-blue-600 to-purple-600 p-6 flex flex-col justify-center items-center text-white">
                                            <p>{t('addWallet')}</p>
                                        </div>
                                    )}
                                    {wallets.map((wallet) => (
                                        <div key={wallet.id} className={`relative group w-72 h-48 rounded-3xl p-6 shadow-lg text-white overflow-hidden shrink-0 transition-transform ${wallet.color === 'purple' ? 'bg-gradient-to-br from-purple-600 to-pink-600' : wallet.color === 'green' ? 'bg-gradient-to-br from-emerald-500 to-teal-600' : 'bg-gradient-to-br from-[#2F54EB] to-[#10239E]'}`}>
                                            <div className="absolute top-4 left-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity z-20">
                                                <button onClick={() => deleteWallet(wallet.id)} className="p-1.5 bg-black/20 hover:bg-red-500/80 rounded-full backdrop-blur"><Icons.Trash2 /></button>
                                                <button onClick={() => { setEditingWallet(wallet); setWalletModalOpen(true); }} className="p-1.5 bg-black/20 hover:bg-white/20 rounded-full backdrop-blur"><Icons.Edit2 /></button>
                                            </div>
                                            <div className="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -mr-10 -mt-10"></div>
                                            <div className="flex flex-col justify-between h-full relative z-10">
                                                <div className="flex justify-between items-start">
                                                    <span className="bg-black/20 px-3 py-1 rounded-full text-xs font-medium backdrop-blur-md">{wallet.name}</span>
                                                    <div className="text-white/60"><Icons.CreditCard /></div>
                                                </div>
                                                <div>
                                                    <p className="text-white/70 text-sm">{t('available')}</p>
                                                    <h3 className="text-3xl font-bold dir-ltr" dir="ltr">{formatMoney(wallet.balance)}</h3>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            
                            <div className="grid grid-cols-2 gap-4 px-6">
                                <div className={`p-4 rounded-2xl border ${colors.card}`}>
                                    <div className="flex items-center gap-2 text-green-500 text-xs uppercase font-bold mb-2">
                                        <div className="p-1 bg-green-500/20 rounded-full"><Icons.ArrowDownLeft /></div>
                                        {t('income')}
                                    </div>
                                    <p className="text-lg font-bold">{formatMoney(stats.income)}</p>
                                </div>
                                <div className={`p-4 rounded-2xl border ${colors.card}`}>
                                    <div className="flex items-center gap-2 text-red-500 text-xs uppercase font-bold mb-2">
                                        <div className="p-1 bg-red-500/20 rounded-full"><Icons.ArrowUpRight /></div>
                                        {t('spent')}
                                    </div>
                                    <p className="text-lg font-bold">{formatMoney(stats.expense)}</p>
                                </div>
                            </div>

                            <div className="px-6">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="font-bold text-lg">{t('recentActivity')}</h3>
                                    <button onClick={() => setView('insights')} className="text-xs text-blue-500 font-medium">{t('seeAll')}</button>
                                </div>
                                <div className="space-y-3">
                                    {transactions.slice(0, 5).map((tx) => (
                                        <div key={tx.id} onClick={() => setEditingTx(tx)} className={`group relative flex items-center justify-between p-4 rounded-2xl border cursor-pointer hover:border-blue-500/50 transition-all ${colors.card}`}>
                                            <div className="flex items-center gap-4">
                                                <div className={`w-12 h-12 rounded-2xl flex items-center justify-center text-xl ${tx.type === 'income' ? 'bg-green-500/10 text-green-500' : 'bg-blue-500/10 text-blue-500'}`}>
                                                    {tx.type === 'income' ? 'üí∞' : 'üõçÔ∏è'}
                                                </div>
                                                <div>
                                                    <p className="font-bold text-sm">{tx.description}</p>
                                                    <p className={`text-xs ${colors.textMuted}`}>{tx.category}</p>
                                                </div>
                                            </div>
                                            <div className="text-right">
                                                <p className={`font-bold ${tx.type === 'income' ? 'text-green-500' : colors.text}`}>
                                                    {tx.type === 'income' ? '+' : '-'}{formatMoney(tx.amount || 0)}
                                                </p>
                                            </div>
                                        </div>
                                    ))}
                                    {transactions.length === 0 && <div className={`text-center py-8 ${colors.textMuted}`}>{t('noTx')}</div>}
                                </div>
                            </div>
                        </div>
                    )}

                    {view === 'planning' && (
                        <div className="px-6 space-y-6 animate-in zoom-in-95 pb-10">
                            <div className="flex justify-between items-center pt-6">
                                <h2 className="text-2xl font-bold">{t('planning')}</h2>
                                <button onClick={() => { setEditingPlanItem(null); setPlanningModalOpen(true); }} className="bg-blue-600 text-white p-2 rounded-full shadow-lg hover:bg-blue-700">
                                    <Icons.Plus />
                                </button>
                            </div>
                            <div>
                                <h3 className="text-sm font-bold text-red-500 uppercase mb-3 flex items-center gap-2"><Icons.ArrowUpRight /> {t('obligations')}</h3>
                                <div className="space-y-3">
                                    {recurringItems.filter(i => i.type === 'obligation').map(item => (
                                        <div key={item.id} className={`p-4 rounded-2xl border flex items-center justify-between ${colors.card} ${item.isPaid ? 'opacity-50' : ''}`}>
                                            <div className="flex items-center gap-3">
                                                <button onClick={() => togglePlanningStatus(item)} className={`p-1 rounded ${item.isPaid ? 'bg-green-500 text-white' : 'bg-gray-200 dark:bg-white/10'}`}>
                                                    {item.isPaid ? <Icons.CheckSquare /> : <Icons.Square />}
                                                </button>
                                                <div>
                                                    <p className={`font-bold ${item.isPaid ? 'line-through' : ''}`}>{item.title}</p>
                                                    <p className="text-xs text-gray-500">{t('dueDate')}: {item.day}</p>
                                                </div>
                                            </div>
                                            <div className="flex items-center gap-3">
                                                <span className="font-bold">{formatMoney(item.amount)}</span>
                                                <button onClick={() => deletePlanningItem(item.id)} className="text-red-500 opacity-20 hover:opacity-100"><Icons.Trash2 /></button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <div>
                                <h3 className="text-sm font-bold text-green-500 uppercase mb-3 flex items-center gap-2"><Icons.ArrowDownLeft /> {t('collections')}</h3>
                                <div className="space-y-3">
                                    {recurringItems.filter(i => i.type === 'collection').map(item => (
                                        <div key={item.id} className={`p-4 rounded-2xl border flex items-center justify-between ${colors.card} ${item.isPaid ? 'opacity-50' : ''}`}>
                                            <div className="flex items-center gap-3">
                                                <button onClick={() => togglePlanningStatus(item)} className={`p-1 rounded ${item.isPaid ? 'bg-green-500 text-white' : 'bg-gray-200 dark:bg-white/10'}`}>
                                                    {item.isPaid ? <Icons.CheckSquare /> : <Icons.Square />}
                                                </button>
                                                <div>
                                                    <p className={`font-bold ${item.isPaid ? 'line-through' : ''}`}>{item.title}</p>
                                                    <p className="text-xs text-gray-500">{t('dueDate')}: {item.day}</p>
                                                </div>
                                            </div>
                                            <div className="flex items-center gap-3">
                                                <span className="font-bold">{formatMoney(item.amount)}</span>
                                                <button onClick={() => deletePlanningItem(item.id)} className="text-red-500 opacity-20 hover:opacity-100"><Icons.Trash2 /></button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}

                    {view === 'insights' && (
                        <div className="px-6 space-y-6 animate-in zoom-in-95 pb-10">
                            <h2 className="text-2xl font-bold pt-6">{t('insights')}</h2>
                            <div className={`p-6 rounded-3xl border ${colors.card}`}>
                                <div className="flex justify-between items-end mb-4">
                                    <div>
                                        <p className={`text-sm ${colors.textMuted} mb-1`}>{t('monthlyCap')}</p>
                                        <p className="text-2xl font-bold">{stats.spendingRate.toFixed(0)}% <span className="text-sm font-normal text-gray-500">ŸÖÿ≥ÿ™ÿÆÿØŸÖ</span></p>
                                    </div>
                                    <div className={`px-3 py-1 rounded-full text-xs font-bold ${stats.spendingRate > 80 ? 'bg-red-500/20 text-red-500' : 'bg-green-500/20 text-green-500'}`}>
                                        {stats.spendingRate > 80 ? t('critical') : t('good')}
                                    </div>
                                </div>
                                <ProgressBar value={stats.expense} max={stats.income || 1} color={stats.spendingRate > 80 ? 'bg-red-500' : 'bg-blue-500'} />
                            </div>

                            <div className={`p-6 rounded-3xl border ${colors.card}`}>
                                <div className="flex items-center gap-2 mb-2">
                                    <div className="text-blue-500"><Icons.BarChart3 /></div>
                                    <h3 className="font-bold text-sm">{t('spendingTrend')}</h3>
                                </div>
                                <SimpleBarChart data={stats.weeklyChart} theme={theme} />
                            </div>

                            <div className={`p-5 rounded-2xl border ${colors.card}`}>
                                <h3 className="font-bold text-sm mb-4">{t('categoryBreakdown')}</h3>
                                <div className="space-y-4">
                                    {stats.categoryList.map((cat, i) => (
                                        <div key={i}>
                                            <div className="flex justify-between text-xs mb-1">
                                                <span>{cat.name}</span>
                                                <span className="font-bold">{formatMoney(cat.value)}</span>
                                            </div>
                                            <ProgressBar value={cat.value} max={stats.expense || 1} color="bg-gray-500" />
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}

                    {view === 'settings' && (
                        <div className="w-full px-6 pt-6 space-y-6 animate-in slide-in-from-right-4">
                            <h2 className={`text-2xl font-bold ${colors.text}`}>{t('settings')}</h2>
                            <div className={`p-4 rounded-2xl border ${colors.card}`}>
                                <h3 className={`text-sm font-medium mb-4 ${colors.textMuted}`}>{t('language')}</h3>
                                <div className="flex gap-2">
                                    <button onClick={() => setLang('en')} className={`flex-1 py-2 rounded-lg text-sm font-bold ${lang === 'en' ? 'bg-blue-600 text-white' : 'bg-gray-800 text-gray-400'}`}>English</button>
                                    <button onClick={() => setLang('ar')} className={`flex-1 py-2 rounded-lg text-sm font-bold ${lang === 'ar' ? 'bg-blue-600 text-white' : 'bg-gray-800 text-gray-400'}`}>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
                                </div>
                            </div>
                            <div className={`p-4 rounded-2xl border ${colors.card}`}>
                                <h3 className={`text-sm font-medium mb-4 ${colors.textMuted}`}>{t('theme')}</h3>
                                <div className="flex gap-2">
                                    <button onClick={() => setTheme('light')} className={`flex-1 py-2 rounded-lg text-sm font-bold ${theme === 'light' ? 'bg-white text-black shadow' : 'bg-gray-800 text-gray-400'}`}>Light</button>
                                    <button onClick={() => setTheme('dark')} className={`flex-1 py-2 rounded-lg text-sm font-bold ${theme === 'dark' ? 'bg-white text-black' : 'bg-gray-800 text-gray-400'}`}>Dark</button>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="fixed bottom-[90px] left-4 right-4 z-40">
                        {aiResult ? (
                            <div className={`p-5 rounded-3xl shadow-2xl border animate-in slide-in-from-bottom-10 ${theme === 'dark' ? 'bg-[#1A1A1A] border-white/10' : 'bg-white border-gray-200'}`}>
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-sm text-blue-500 font-bold uppercase">{t('aiDetected')}</h3>
                                    <button onClick={() => setAiResult(null)}><div className={colors.textMuted}><Icons.X /></div></button>
                                </div>
                                <div className="space-y-3 mb-6">
                                    <div className="flex justify-between"><span className={colors.textMuted}>{t('amount')}</span><span className="text-2xl font-bold">{formatMoney(aiResult.amount || 0)}</span></div>
                                    <div className="flex justify-between"><span className={colors.textMuted}>{t('category')}</span><span className={`px-2 py-1 rounded text-sm ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-100'}`}>{aiResult.category}</span></div>
                                    <div className="flex justify-between"><span className={colors.textMuted}>{t('note')}</span><span className="text-sm font-medium">{aiResult.description}</span></div>
                                </div>
                                <button onClick={() => saveTransaction(aiResult)} className="w-full py-4 bg-blue-600 hover:bg-blue-500 rounded-xl font-bold text-white shadow-lg shadow-blue-500/30">{t('confirmSave')}</button>
                            </div>
                        ) : (
                            <form onSubmit={handleCommand} className={`flex items-center rounded-full h-14 px-4 border shadow-lg transition-all ${colors.input} ${isProcessing ? 'border-blue-500 ring-2 ring-blue-500/20' : ''}`}>
                                <div className={`p-2 rounded-full ${isProcessing ? 'bg-blue-500 text-white animate-pulse' : 'text-blue-500'}`}><Icons.Mic /></div>
                                <input type="text" value={command} onChange={(e) => setCommand(e.target.value)} placeholder={t('sayPlaceholder')} className={`flex-1 bg-transparent outline-none px-3 text-[16px] ${theme === 'dark' ? 'placeholder-gray-600' : 'placeholder-gray-400'}`} />
                                <button type="submit" className="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white shadow-lg shadow-blue-600/30">
                                    {isProcessing ? <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"/> : <div className={lang === 'ar' ? 'rotate-180' : ''}><Icons.ArrowUpRight /></div>}
                                </button>
                            </form>
                        )}
                    </div>

                    <Modal isOpen={walletModalOpen} onClose={() => setWalletModalOpen(false)} title={editingWallet ? t('editWallet') : t('addWallet')} theme={theme}>
                        <form onSubmit={saveWallet} className="space-y-4">
                            <div><label className="text-sm text-gray-500">{t('walletName')}</label><input name="name" defaultValue={editingWallet?.name} required className={`w-full p-3 rounded-xl outline-none border mt-1 ${colors.input}`} placeholder="Ex: Cash, CIB Bank..." /></div>
                            <div><label className="text-sm text-gray-500">{t('initialBalance')}</label><input name="balance" type="number" step="0.01" defaultValue={editingWallet?.balance} required className={`w-full p-3 rounded-xl outline-none border mt-1 ${colors.input}`} /></div>
                            <div>
                                <label className="text-sm text-gray-500">Color</label>
                                <div className="flex gap-2 mt-2">
                                    {['blue', 'purple', 'green'].map(c => (
                                        <label key={c} className={`w-8 h-8 rounded-full cursor-pointer border-2 ${editingWallet?.color === c ? 'border-white' : 'border-transparent'}`} style={{backgroundColor: c === 'blue' ? '#2F54EB' : c === 'purple' ? '#9333ea' : '#10b981'}}>
                                            <input type="radio" name="color" value={c} defaultChecked={editingWallet?.color === c} className="hidden" />
                                        </label>
                                    ))}
                                </div>
                            </div>
                            <button type="submit" className="w-full py-3 bg-blue-600 rounded-xl text-white font-bold mt-4">{t('save')}</button>
                        </form>
                    </Modal>

                    <Modal isOpen={planningModalOpen} onClose={() => setPlanningModalOpen(false)} title={t('addToTitle')} theme={theme}>
                        <form onSubmit={savePlanningItem} className="space-y-4">
                            <div>
                                <label className="text-sm text-gray-500">{t('type')}</label>
                                <select name="type" defaultValue={editingPlanItem?.type || 'obligation'} className={`w-full p-3 rounded-xl outline-none border mt-1 ${colors.input}`}>
                                    <option value="obligation">{t('obligations')}</option>
                                    <option value="collection">{t('collections')}</option>
                                </select>
                            </div>
                            <div><label className="text-sm text-gray-500">Title</label><input name="title" defaultValue={editingPlanItem?.title} required className={`w-full p-3 rounded-xl outline-none border mt-1 ${colors.input}`} placeholder="Ex: Rent, Internet..." /></div>
                            <div><label className="text-sm text-gray-500">{t('amount')}</label><input name="amount" type="number" defaultValue={editingPlanItem?.amount} required className={`w-full p-3 rounded-xl outline-none border mt-1 ${colors.input}`} /></div>
                            <div><label className="text-sm text-gray-500">{t('dueDate')} (Day of month)</label><input name="day" type="number" min="1" max="31" defaultValue={editingPlanItem?.day || 1} required className={`w-full p-3 rounded-xl outline-none border mt-1 ${colors.input}`} /></div>
                            <button type="submit" className="w-full py-3 bg-blue-600 rounded-xl text-white font-bold mt-4">{t('save')}</button>
                        </form>
                    </Modal>

                    <Modal isOpen={!!editingTx} onClose={() => setEditingTx(null)} title={t('edit')} theme={theme}>
                        <div className="space-y-4">
                            <input value={editingTx?.description} onChange={e => setEditingTx({...editingTx, description: e.target.value})} className={`w-full p-3 rounded-xl border ${colors.input}`} />
                            <input type="number" value={editingTx?.amount} onChange={e => setEditingTx({...editingTx, amount: parseFloat(e.target.value)})} className={`w-full p-3 rounded-xl border ${colors.input}`} />
                            <div className="flex gap-2">
                                <button onClick={() => deleteTransaction(editingTx.id)} className="flex-1 py-3 bg-red-500/10 text-red-500 rounded-xl font-bold">{t('delete')}</button>
                                <button onClick={() => saveTransaction(editingTx)} className="flex-1 py-3 bg-blue-600 text-white rounded-xl font-bold">{t('save')}</button>
                            </div>
                        </div>
                    </Modal>

                    <div className={`fixed bottom-0 left-0 right-0 border-t pb-6 pt-3 px-6 flex justify-between z-40 backdrop-blur-xl ${colors.nav}`}>
                        {[
                            { id: 'home', icon: Icons.Wallet, label: t('home') },
                            { id: 'insights', icon: Icons.BarChart3, label: t('insights') },
                            { id: 'planning', icon: Icons.Calendar, label: t('planning') },
                            { id: 'settings', icon: Icons.Settings, label: t('settings') },
                        ].map(item => (
                            <button key={item.id} onClick={() => setView(item.id)} className={`flex flex-col items-center space-y-1 ${view === item.id ? 'text-blue-600' : 'text-gray-400'}`}>
                                <item.icon />
                                <span className="text-[10px] font-medium">{item.label}</span>
                            </button>
                        ))}
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SmartWallet />);
    </script>
</body>
</html>
